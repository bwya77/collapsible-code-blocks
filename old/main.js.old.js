/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => CollapsibleCodeBlockPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  defaultCollapsed: false,
  collapseIcon: "\u25BC",
  expandIcon: "\u25B6",
  enableHorizontalScroll: true,
  collapsedLines: 0
};
var CollapsibleCodeBlockPlugin = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.updateScrollSetting();
    this.viewportObserver = new IntersectionObserver(
      (entries) => entries.forEach((entry) => {
        if (entry.isIntersecting && entry.target instanceof HTMLElement) {
          this.updateCodeBlockVisibility(entry.target);
        }
      }),
      { rootMargin: "100px", threshold: [0, 0.5, 1] }
    );
    this.contentObserver = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        if (mutation.type === "childList") {
          this.processNewCodeBlocks(mutation.target);
        }
      });
    });
    this.registerMarkdownPostProcessor((element) => {
      this.processNewCodeBlocks(element);
      this.contentObserver.observe(element, { childList: true, subtree: true });
    });
    this.addSettingTab(new CollapsibleCodeBlockSettingsTab(this.app, this));
  }
  processNewCodeBlocks(element) {
    element.querySelectorAll("pre:not(.has-collapse-button)").forEach((pre) => {
      if (!(pre instanceof HTMLElement))
        return;
      pre.classList.add("has-collapse-button");
      this.setupCodeBlock(pre);
      this.viewportObserver.observe(pre);
    });
  }
  setupCodeBlock(pre) {
    document.documentElement.style.setProperty("--collapsed-lines", this.settings.collapsedLines.toString());
    const toggleButton = this.createToggleButton();
    pre.insertBefore(toggleButton, pre.firstChild);
    if (this.settings.defaultCollapsed) {
      pre.classList.add("collapsed");
      toggleButton.textContent = this.settings.expandIcon;
      this.updateCodeBlockVisibility(pre);
    }
  }
  createToggleButton() {
    const button = document.createElement("div");
    button.className = "code-block-toggle";
    button.textContent = this.settings.collapseIcon;
    button.setAttribute("role", "button");
    button.setAttribute("tabindex", "0");
    button.setAttribute("aria-label", "Toggle code block visibility");
    const toggleHandler = (e) => {
      e.preventDefault();
      const pre = e.target.closest("pre");
      if (!pre)
        return;
      pre.classList.toggle("collapsed");
      this.updateCodeBlockVisibility(pre);
      const isCollapsed = pre.classList.contains("collapsed");
      button.textContent = isCollapsed ? this.settings.expandIcon : this.settings.collapseIcon;
      button.setAttribute("aria-expanded", (!isCollapsed).toString());
      this.app.workspace.requestSaveLayout();
    };
    button.addEventListener("click", toggleHandler);
    button.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        toggleHandler(e);
      }
    });
    return button;
  }
  updateCodeBlockVisibility(pre) {
    var _a;
    const isCollapsed = pre.classList.contains("collapsed");
    let elements = [];
    let curr = pre.nextElementSibling;
    while (curr && !(curr instanceof HTMLPreElement)) {
      if (curr instanceof HTMLElement) {
        elements.push(curr);
        if (!curr.dataset.originalDisplay) {
          curr.dataset.originalDisplay = getComputedStyle(curr).display;
        }
      }
      curr = curr.nextElementSibling;
    }
    const markdownView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if ((_a = markdownView == null ? void 0 : markdownView.previewMode) == null ? void 0 : _a.containerEl) {
      const previewElement = markdownView.previewMode.containerEl;
      setTimeout(() => {
        elements.forEach((el) => {
          if (isCollapsed) {
            el.classList.add("element-hidden");
            el.classList.remove("element-visible", "element-spacing");
          } else {
            el.classList.remove("element-hidden");
            el.classList.add("element-visible");
            const preRect = pre.getBoundingClientRect();
            const elRect = el.getBoundingClientRect();
            if (elRect.top < preRect.bottom) {
              document.documentElement.style.setProperty("--element-spacing", `${preRect.bottom - elRect.top + 10}px`);
              el.classList.add("element-spacing");
            }
          }
        });
        void previewElement.offsetHeight;
        previewElement.dispatchEvent(new Event("scroll", { bubbles: true }));
        window.dispatchEvent(new Event("resize"));
        const currentScroll = previewElement.scrollTop;
        if (currentScroll > 0) {
          previewElement.scrollTop = currentScroll - 1;
          requestAnimationFrame(() => {
            previewElement.scrollTop = currentScroll;
            setTimeout(() => {
              previewElement.dispatchEvent(new Event("scroll", { bubbles: true }));
            }, 50);
          });
        } else {
          previewElement.scrollTop = 1;
          requestAnimationFrame(() => {
            previewElement.scrollTop = 0;
            setTimeout(() => {
              previewElement.dispatchEvent(new Event("scroll", { bubbles: true }));
            }, 50);
          });
        }
      }, 50);
    }
  }
  updateScrollSetting() {
    document.body.classList.toggle("horizontal-scroll", this.settings.enableHorizontalScroll);
  }
  sanitizeIcon(icon) {
    const cleaned = icon.trim();
    return cleaned.length <= 2 ? cleaned : DEFAULT_SETTINGS.collapseIcon;
  }
  async loadSettings() {
    var _a, _b;
    const loadedData = await this.loadData();
    this.settings = {
      ...DEFAULT_SETTINGS,
      ...loadedData,
      // Sanitize icons when loading
      collapseIcon: this.sanitizeIcon((_a = loadedData == null ? void 0 : loadedData.collapseIcon) != null ? _a : DEFAULT_SETTINGS.collapseIcon),
      expandIcon: this.sanitizeIcon((_b = loadedData == null ? void 0 : loadedData.expandIcon) != null ? _b : DEFAULT_SETTINGS.expandIcon)
    };
  }
  async saveSettings() {
    this.settings.collapseIcon = this.sanitizeIcon(this.settings.collapseIcon);
    this.settings.expandIcon = this.sanitizeIcon(this.settings.expandIcon);
    await this.saveData(this.settings);
  }
  onunload() {
    var _a, _b;
    (_a = this.contentObserver) == null ? void 0 : _a.disconnect();
    (_b = this.viewportObserver) == null ? void 0 : _b.disconnect();
  }
};
var CollapsibleCodeBlockSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Collapsible Code Block Settings" });
    new import_obsidian.Setting(containerEl).setName("Default Collapsed State").setDesc("Should code blocks be collapsed by default?").addToggle((toggle) => toggle.setValue(this.plugin.settings.defaultCollapsed).onChange(async (value) => {
      this.plugin.settings.defaultCollapsed = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Collapse Icon").setDesc("Icon to show when code block is expanded (single character or emoji only)").addText((text) => text.setValue(this.plugin.settings.collapseIcon).onChange(async (value) => {
      const sanitized = value.trim();
      if (sanitized.length <= 2) {
        this.plugin.settings.collapseIcon = sanitized || DEFAULT_SETTINGS.collapseIcon;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian.Setting(containerEl).setName("Expand Icon").setDesc("Icon to show when code block is collapsed (single character or emoji only)").addText((text) => text.setValue(this.plugin.settings.expandIcon).onChange(async (value) => {
      const sanitized = value.trim();
      if (sanitized.length <= 2) {
        this.plugin.settings.expandIcon = sanitized || DEFAULT_SETTINGS.expandIcon;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian.Setting(containerEl).setName("Enable Horizontal Scrolling").setDesc("Allow code blocks to scroll horizontally instead of wrapping text.").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableHorizontalScroll).onChange(async (value) => {
      this.plugin.settings.enableHorizontalScroll = value;
      await this.plugin.saveSettings();
      this.plugin.updateScrollSetting();
    }));
    const collapsedLinesSetting = new import_obsidian.Setting(containerEl).setName("Collapsed Lines").setDesc("Number of lines visible when code block is collapsed");
    let reloadButton = null;
    collapsedLinesSetting.addButton((btn) => {
      reloadButton = btn.setButtonText("Apply changes (reload plugin)").setCta();
      reloadButton.buttonEl.classList.add("hidden");
      reloadButton.onClick(async () => {
        const pluginId = this.plugin.manifest.id;
        await this.app.plugins.disablePlugin(pluginId);
        await this.app.plugins.enablePlugin(pluginId);
        this.app.setting.openTabById(pluginId);
      });
    });
    collapsedLinesSetting.addText((text) => {
      text.setValue(this.plugin.settings.collapsedLines.toString()).onChange(async (value) => {
        const numericValue = parseInt(value, 10);
        this.plugin.settings.collapsedLines = isNaN(numericValue) || numericValue < 0 ? 0 : numericValue;
        await this.plugin.saveSettings();
        if (reloadButton) {
          reloadButton.buttonEl.classList.remove("hidden");
        }
      });
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcbiAgICBQbHVnaW4sXG4gICAgTWFya2Rvd25WaWV3LFxuICAgIFBsdWdpblNldHRpbmdUYWIsXG4gICAgQXBwLFxuICAgIFNldHRpbmcsXG4gICAgQnV0dG9uQ29tcG9uZW50XG59IGZyb20gJ29ic2lkaWFuJztcblxuaW50ZXJmYWNlIENvbGxhcHNpYmxlQ29kZUJsb2NrU2V0dGluZ3Mge1xuICAgIGRlZmF1bHRDb2xsYXBzZWQ6IGJvb2xlYW47XG4gICAgY29sbGFwc2VJY29uOiBzdHJpbmc7XG4gICAgZXhwYW5kSWNvbjogc3RyaW5nO1xuICAgIGVuYWJsZUhvcml6b250YWxTY3JvbGw6IGJvb2xlYW47XG4gICAgY29sbGFwc2VkTGluZXM6IG51bWJlcjtcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogQ29sbGFwc2libGVDb2RlQmxvY2tTZXR0aW5ncyA9IHtcbiAgICBkZWZhdWx0Q29sbGFwc2VkOiBmYWxzZSxcbiAgICBjb2xsYXBzZUljb246ICdcdTI1QkMnLFxuICAgIGV4cGFuZEljb246ICdcdTI1QjYnLFxuICAgIGVuYWJsZUhvcml6b250YWxTY3JvbGw6IHRydWUsXG4gICAgY29sbGFwc2VkTGluZXM6IDBcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbGxhcHNpYmxlQ29kZUJsb2NrUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBwcml2YXRlIGNvbnRlbnRPYnNlcnZlcjogTXV0YXRpb25PYnNlcnZlcjtcbiAgICBwcml2YXRlIHZpZXdwb3J0T2JzZXJ2ZXI6IEludGVyc2VjdGlvbk9ic2VydmVyO1xuICAgIHB1YmxpYyBzZXR0aW5nczogQ29sbGFwc2libGVDb2RlQmxvY2tTZXR0aW5ncztcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxTZXR0aW5nKCk7XG5cbiAgICAgICAgLy8gU2luZ2xlIHZpZXdwb3J0IG9ic2VydmVyIGZvciBhbGwgY29kZSBibG9ja3NcbiAgICAgICAgdGhpcy52aWV3cG9ydE9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKFxuICAgICAgICAgICAgKGVudHJpZXMpID0+IGVudHJpZXMuZm9yRWFjaChlbnRyeSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nICYmIGVudHJ5LnRhcmdldCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29kZUJsb2NrVmlzaWJpbGl0eShlbnRyeS50YXJnZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgeyByb290TWFyZ2luOiBcIjEwMHB4XCIsIHRocmVzaG9sZDogWzAsIDAuNSwgMS4wXSB9XG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gU2luZ2xlIGNvbnRlbnQgb2JzZXJ2ZXIgZm9yIHRoZSBlbnRpcmUgcHJldmlld1xuICAgICAgICB0aGlzLmNvbnRlbnRPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHtcbiAgICAgICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKG11dGF0aW9uID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoaWxkTGlzdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzTmV3Q29kZUJsb2NrcyhtdXRhdGlvbi50YXJnZXQgYXMgSFRNTEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NOZXdDb2RlQmxvY2tzKGVsZW1lbnQpO1xuICAgICAgICAgICAgdGhpcy5jb250ZW50T2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50LCB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBDb2xsYXBzaWJsZUNvZGVCbG9ja1NldHRpbmdzVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBwcm9jZXNzTmV3Q29kZUJsb2NrcyhlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3ByZTpub3QoLmhhcy1jb2xsYXBzZS1idXR0b24pJykuZm9yRWFjaChwcmUgPT4ge1xuICAgICAgICAgICAgaWYgKCEocHJlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSByZXR1cm47XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHByZS5jbGFzc0xpc3QuYWRkKCdoYXMtY29sbGFwc2UtYnV0dG9uJyk7XG4gICAgICAgICAgICB0aGlzLnNldHVwQ29kZUJsb2NrKHByZSk7XG4gICAgICAgICAgICB0aGlzLnZpZXdwb3J0T2JzZXJ2ZXIub2JzZXJ2ZShwcmUpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldHVwQ29kZUJsb2NrKHByZTogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLWNvbGxhcHNlZC1saW5lcycsIHRoaXMuc2V0dGluZ3MuY29sbGFwc2VkTGluZXMudG9TdHJpbmcoKSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0b2dnbGVCdXR0b24gPSB0aGlzLmNyZWF0ZVRvZ2dsZUJ1dHRvbigpO1xuICAgICAgICBwcmUuaW5zZXJ0QmVmb3JlKHRvZ2dsZUJ1dHRvbiwgcHJlLmZpcnN0Q2hpbGQpO1xuXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmRlZmF1bHRDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIHByZS5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTtcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuc2V0dGluZ3MuZXhwYW5kSWNvbjtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29kZUJsb2NrVmlzaWJpbGl0eShwcmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVUb2dnbGVCdXR0b24oKTogSFRNTEVsZW1lbnQge1xuICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgYnV0dG9uLmNsYXNzTmFtZSA9ICdjb2RlLWJsb2NrLXRvZ2dsZSc7XG4gICAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuc2V0dGluZ3MuY29sbGFwc2VJY29uO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdyb2xlJywgJ2J1dHRvbicpO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnVG9nZ2xlIGNvZGUgYmxvY2sgdmlzaWJpbGl0eScpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgdG9nZ2xlSGFuZGxlciA9IChlOiBFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgY29uc3QgcHJlID0gKGUudGFyZ2V0IGFzIEhUTUxFbGVtZW50KS5jbG9zZXN0KCdwcmUnKTtcbiAgICAgICAgICAgIGlmICghcHJlKSByZXR1cm47XG5cbiAgICAgICAgICAgIHByZS5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29kZUJsb2NrVmlzaWJpbGl0eShwcmUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBpc0NvbGxhcHNlZCA9IHByZS5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbGxhcHNlZCcpO1xuICAgICAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gaXNDb2xsYXBzZWQgPyB0aGlzLnNldHRpbmdzLmV4cGFuZEljb24gOiB0aGlzLnNldHRpbmdzLmNvbGxhcHNlSWNvbjtcbiAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAoIWlzQ29sbGFwc2VkKS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5yZXF1ZXN0U2F2ZUxheW91dCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZUhhbmRsZXIpO1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgfHwgZS5rZXkgPT09ICcgJykge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0b2dnbGVIYW5kbGVyKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYnV0dG9uO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlQ29kZUJsb2NrVmlzaWJpbGl0eShwcmU6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGlzQ29sbGFwc2VkID0gcHJlLmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgZm9sbG93aW5nIGVsZW1lbnRzJyB2aXNpYmlsaXR5IGFuZCBwb3NpdGlvbmluZ1xuICAgICAgICBsZXQgZWxlbWVudHM6IEhUTUxFbGVtZW50W10gPSBbXTtcbiAgICAgICAgbGV0IGN1cnIgPSBwcmUubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICBcbiAgICAgICAgd2hpbGUgKGN1cnIgJiYgIShjdXJyIGluc3RhbmNlb2YgSFRNTFByZUVsZW1lbnQpKSB7XG4gICAgICAgICAgICBpZiAoY3VyciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudHMucHVzaChjdXJyKTtcbiAgICAgICAgICAgICAgICAvLyBTdG9yZSBvcmlnaW5hbCBkaXNwbGF5IGlmIG5vdCBhbHJlYWR5IHN0b3JlZFxuICAgICAgICAgICAgICAgIGlmICghY3Vyci5kYXRhc2V0Lm9yaWdpbmFsRGlzcGxheSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyLmRhdGFzZXQub3JpZ2luYWxEaXNwbGF5ID0gZ2V0Q29tcHV0ZWRTdHlsZShjdXJyKS5kaXNwbGF5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnIgPSBjdXJyLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvcmNlIGxheW91dCByZWNhbGN1bGF0aW9uXG4gICAgICAgIGNvbnN0IG1hcmtkb3duVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmIChtYXJrZG93blZpZXc/LnByZXZpZXdNb2RlPy5jb250YWluZXJFbCkge1xuICAgICAgICAgICAgY29uc3QgcHJldmlld0VsZW1lbnQgPSBtYXJrZG93blZpZXcucHJldmlld01vZGUuY29udGFpbmVyRWw7XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBlbGVtZW50IHZpc2liaWxpdHlcbiAgICAgICAgICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdlbGVtZW50LWhpZGRlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnZWxlbWVudC12aXNpYmxlJywgJ2VsZW1lbnQtc3BhY2luZycpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnZWxlbWVudC1oaWRkZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2VsZW1lbnQtdmlzaWJsZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBlbGVtZW50IG5lZWRzIHJlcG9zaXRpb25pbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZVJlY3QgPSBwcmUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbFJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbFJlY3QudG9wIDwgcHJlUmVjdC5ib3R0b20pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tZWxlbWVudC1zcGFjaW5nJywgYCR7cHJlUmVjdC5ib3R0b20gLSBlbFJlY3QudG9wICsgMTB9cHhgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdlbGVtZW50LXNwYWNpbmcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gRm9yY2UgbXVsdGlwbGUgdmlld3BvcnQgcmVjYWxjdWxhdGlvbnNcbiAgICAgICAgICAgICAgICB2b2lkIHByZXZpZXdFbGVtZW50Lm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHNjcm9sbCBldmVudHMgdG8gZm9yY2UgT2JzaWRpYW4gdG8gdXBkYXRlXG4gICAgICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Njcm9sbCcsIHsgYnViYmxlczogdHJ1ZSB9KSk7XG4gICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdyZXNpemUnKSk7XG5cbiAgICAgICAgICAgICAgICAvLyBBZGRpdGlvbmFsIHNjcm9sbCBqdWdnbGluZyB0byBmb3JjZSByZWZyZXNoXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFNjcm9sbCA9IHByZXZpZXdFbGVtZW50LnNjcm9sbFRvcDtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFNjcm9sbCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuc2Nyb2xsVG9wID0gY3VycmVudFNjcm9sbCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5zY3JvbGxUb3AgPSBjdXJyZW50U2Nyb2xsO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT25lIGZpbmFsIHNjcm9sbCBldmVudCBhZnRlciBldmVyeXRoaW5nIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdFbGVtZW50LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzY3JvbGwnLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5zY3JvbGxUb3AgPSAxO1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdFbGVtZW50LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzY3JvbGwnLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB1cGRhdGVTY3JvbGxTZXR0aW5nKCk6IHZvaWQge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoJ2hvcml6b250YWwtc2Nyb2xsJywgdGhpcy5zZXR0aW5ncy5lbmFibGVIb3Jpem9udGFsU2Nyb2xsKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNhbml0aXplSWNvbihpY29uOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBjbGVhbmVkID0gaWNvbi50cmltKCk7XG4gICAgICAgIHJldHVybiBjbGVhbmVkLmxlbmd0aCA8PSAyID8gY2xlYW5lZCA6IERFRkFVTFRfU0VUVElOR1MuY29sbGFwc2VJY29uO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgY29uc3QgbG9hZGVkRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHtcbiAgICAgICAgICAgIC4uLkRFRkFVTFRfU0VUVElOR1MsXG4gICAgICAgICAgICAuLi5sb2FkZWREYXRhLFxuICAgICAgICAgICAgLy8gU2FuaXRpemUgaWNvbnMgd2hlbiBsb2FkaW5nXG4gICAgICAgICAgICBjb2xsYXBzZUljb246IHRoaXMuc2FuaXRpemVJY29uKGxvYWRlZERhdGE/LmNvbGxhcHNlSWNvbiA/PyBERUZBVUxUX1NFVFRJTkdTLmNvbGxhcHNlSWNvbiksXG4gICAgICAgICAgICBleHBhbmRJY29uOiB0aGlzLnNhbml0aXplSWNvbihsb2FkZWREYXRhPy5leHBhbmRJY29uID8/IERFRkFVTFRfU0VUVElOR1MuZXhwYW5kSWNvbilcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIC8vIFNhbml0aXplIGJlZm9yZSBzYXZpbmdcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5jb2xsYXBzZUljb24gPSB0aGlzLnNhbml0aXplSWNvbih0aGlzLnNldHRpbmdzLmNvbGxhcHNlSWNvbik7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MuZXhwYW5kSWNvbiA9IHRoaXMuc2FuaXRpemVJY29uKHRoaXMuc2V0dGluZ3MuZXhwYW5kSWNvbik7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIHRoaXMuY29udGVudE9ic2VydmVyPy5kaXNjb25uZWN0KCk7XG4gICAgICAgIHRoaXMudmlld3BvcnRPYnNlcnZlcj8uZGlzY29ubmVjdCgpO1xuICAgIH1cbn1cblxuY2xhc3MgQ29sbGFwc2libGVDb2RlQmxvY2tTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogQ29sbGFwc2libGVDb2RlQmxvY2tQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBDb2xsYXBzaWJsZUNvZGVCbG9ja1BsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnQ29sbGFwc2libGUgQ29kZSBCbG9jayBTZXR0aW5ncycgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGVmYXVsdCBDb2xsYXBzZWQgU3RhdGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1Nob3VsZCBjb2RlIGJsb2NrcyBiZSBjb2xsYXBzZWQgYnkgZGVmYXVsdD8nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRDb2xsYXBzZWQpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0Q29sbGFwc2VkID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdDb2xsYXBzZSBJY29uJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdJY29uIHRvIHNob3cgd2hlbiBjb2RlIGJsb2NrIGlzIGV4cGFuZGVkIChzaW5nbGUgY2hhcmFjdGVyIG9yIGVtb2ppIG9ubHkpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb2xsYXBzZUljb24pXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzYW5pdGl6ZWQgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzYW5pdGl6ZWQubGVuZ3RoIDw9IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbGxhcHNlSWNvbiA9IHNhbml0aXplZCB8fCBERUZBVUxUX1NFVFRJTkdTLmNvbGxhcHNlSWNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0V4cGFuZCBJY29uJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdJY29uIHRvIHNob3cgd2hlbiBjb2RlIGJsb2NrIGlzIGNvbGxhcHNlZCAoc2luZ2xlIGNoYXJhY3RlciBvciBlbW9qaSBvbmx5KScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhwYW5kSWNvbilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNhbml0aXplZCA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNhbml0aXplZC5sZW5ndGggPD0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhwYW5kSWNvbiA9IHNhbml0aXplZCB8fCBERUZBVUxUX1NFVFRJTkdTLmV4cGFuZEljb247XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdFbmFibGUgSG9yaXpvbnRhbCBTY3JvbGxpbmcnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0FsbG93IGNvZGUgYmxvY2tzIHRvIHNjcm9sbCBob3Jpem9udGFsbHkgaW5zdGVhZCBvZiB3cmFwcGluZyB0ZXh0LicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlSG9yaXpvbnRhbFNjcm9sbClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUhvcml6b250YWxTY3JvbGwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZVNjcm9sbFNldHRpbmcoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgY29uc3QgY29sbGFwc2VkTGluZXNTZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ29sbGFwc2VkIExpbmVzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdOdW1iZXIgb2YgbGluZXMgdmlzaWJsZSB3aGVuIGNvZGUgYmxvY2sgaXMgY29sbGFwc2VkJyk7XG5cbiAgICAgICAgbGV0IHJlbG9hZEJ1dHRvbjogQnV0dG9uQ29tcG9uZW50IHwgbnVsbCA9IG51bGw7XG5cbiAgICAgICAgY29sbGFwc2VkTGluZXNTZXR0aW5nLmFkZEJ1dHRvbihidG4gPT4ge1xuICAgICAgICAgICAgcmVsb2FkQnV0dG9uID0gYnRuXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0FwcGx5IGNoYW5nZXMgKHJlbG9hZCBwbHVnaW4pJylcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlbG9hZEJ1dHRvbi5idXR0b25FbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcblxuICAgICAgICAgICAgcmVsb2FkQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBsdWdpbklkID0gdGhpcy5wbHVnaW4ubWFuaWZlc3QuaWQ7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnBsdWdpbnMuZGlzYWJsZVBsdWdpbihwbHVnaW5JZCk7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnBsdWdpbnMuZW5hYmxlUGx1Z2luKHBsdWdpbklkKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSZS1vcGVuIHRoZSBzZXR0aW5nc1xuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLm9wZW5UYWJCeUlkKHBsdWdpbklkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb2xsYXBzZWRMaW5lc1NldHRpbmcuYWRkVGV4dCh0ZXh0ID0+IHtcbiAgICAgICAgICAgIHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY29sbGFwc2VkTGluZXMudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG51bWVyaWNWYWx1ZSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbGxhcHNlZExpbmVzID0gaXNOYU4obnVtZXJpY1ZhbHVlKSB8fCBudW1lcmljVmFsdWUgPCAwID8gMCA6IG51bWVyaWNWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbG9hZEJ1dHRvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVsb2FkQnV0dG9uLmJ1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBT087QUFVUCxJQUFNLG1CQUFpRDtBQUFBLEVBQ25ELGtCQUFrQjtBQUFBLEVBQ2xCLGNBQWM7QUFBQSxFQUNkLFlBQVk7QUFBQSxFQUNaLHdCQUF3QjtBQUFBLEVBQ3hCLGdCQUFnQjtBQUNwQjtBQUVBLElBQXFCLDZCQUFyQixjQUF3RCx1QkFBTztBQUFBLEVBSzNELE1BQU0sU0FBUztBQUNYLFVBQU0sS0FBSyxhQUFhO0FBQ3hCLFNBQUssb0JBQW9CO0FBR3pCLFNBQUssbUJBQW1CLElBQUk7QUFBQSxNQUN4QixDQUFDLFlBQVksUUFBUSxRQUFRLFdBQVM7QUFDbEMsWUFBSSxNQUFNLGtCQUFrQixNQUFNLGtCQUFrQixhQUFhO0FBQzdELGVBQUssMEJBQTBCLE1BQU0sTUFBTTtBQUFBLFFBQy9DO0FBQUEs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
